[build]
builder = "NIXPACKS"

[deploy]
healthcheckPath = "/health"
healthcheckTimeout = 100
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10

[[services]]
name = "backend"

[services.variables]
NODE_ENV = "production"
PORT = "8080"

# Use custom start script that runs migrations
[services.start_command]
cmd = "npm run railway:start"